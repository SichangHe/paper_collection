# Integrating Content Authenticity With Dash Video Streaming

Stefano Petrangeli, Haoliang Wang, Maurice Fisher, Dave Kozma

![0_image_0.png](0_image_0.png)

Massy Mahamli, Pia Blumenthal, Andy Parsons
{petrange,hawang,mfisher,dkozma,mmahamli,piab,andyp}@adobe.com Adobe San Jose, California, USA
Figure 1. A UI view of the proposed Content Provenance and Authenticity (C2PA) DASH-based video player. DASH segments are cryptographically signed and associated with C2PA information. During streaming, each segment is validated and C2PA information are shown to the end-user. The timeline is color-coded, allowing viewers to quickly identify portions of the video that has failed the C2PA validation (in red).

Permission to make digital or hard copies of all or part of this work for personal or classroom use is granted without fee provided that copies are not made or distributed for profit or commercial advantage and that copies bear this notice and the full citation on the first page. Copyrights for components of this work owned by others than the author(s) must be honored. Abstracting with credit is permitted. To copy otherwise, or republish, to post on servers or to redistribute to lists, requires prior specific permission and/or a fee. Request permissions from permissions@acm.org.

# Abstract

The importance of content authenticity and provenance has significantly increased in the digital era, due to the rampant spread of misinformation, which makes it necessary to build safe and trustworthy systems. To this effect, the Coalition for Content Provenance and Authenticity (C2PA) has emerged as a leading organization that provides content provenance (https://c2pa.org/), certifying the source and history of media content, which empowers users to assess the authenticity and trustworthiness of a piece of content. The group has created the specification and various tools for generating, attaching, and verifying C2PA manifest for different media assets such as audio, image, and video files. However, there is still a gap when it comes to video streaming,

MMSys '24, April 15–18, 2024, Bari, Italy
© 2024 Copyright held by the owner/author(s). Publication rights licensed to ACM. ACM ISBN 979-8-4007-0412-3/24/04 https://doi.org/10.1145/3625468.3652198
where fragmented MP4 (fMP4) files are commonly used. Although the C2PA standard has specified the manifest generation of fMP4 files, the verification and visualization of the result during consumption is left unspecified. In this paper, we introduce a client-side implementation of C2PA validation for video streaming. Our solution builds on top of DASH.js for the player engine and video.js for the player UI. As the content plays, the provenance verification result is displayed on the player UI through the timeline and an C2PA icon, reflecting whether the verification has passed for the content being viewed. Viewers can also quickly check additional information, such as the content authors and editing history, using a second-level menu by clicking the icon. Our demo showcases that our solution provides robust verification, smooth playback, and an intuitive UI for users to stream videos with content authenticity.

## Ccs Concepts: - Information Systems → Multimedia Streaming.

Keywords: Content Authenticity, Content Provenance, DASH, Video Streaming, UI

#### Acm Reference Format:

Stefano Petrangeli, Haoliang Wang, Maurice Fisher, Dave Kozma, Massy Mahamli, Pia Blumenthal, Andy Parsons. 2024. Integrating Content Authenticity with DASH Video Streaming. In *ACM Multimedia Systems Conference 2024 (MMSys*
'24), April 15–18, 2024, Bari, Italy. ACM, New York, NY, USA,
7 pages. https://doi.org/10.1145/3625468.3652198

# 1 Introduction

With the proliferation of sophisticated digital tools to create and edit content, it is becoming increasingly challenging to fight the spread of misinformation over the Internet. This trend has been exacerbated by the flourishing of Generative AI technologies [11], that can generate realistic text, images and videos in just a few clicks. It is therefore becoming imperative to create technologies that can help users understand the provenance of a certain content and make their own determination of whether the content should be trusted.

The Coalition for Content Provenance and Authenticity (C2PA) has been addressing this problem by developing a set of technical standards for certifying the source and history (or provenance) of media content. C2PA is a Joint Development Foundation project, formed through an alliance between Adobe, Arm, Intel, Microsoft and Truepic [6], with a growing set of members. Among others, the C2PA standard has been recently adopted by OpenAI for images generated by DALL·E [14]. In C2PA terminology, content is securely bind with a set of *Credentials*. These credentials may include information about who created the content and how, when, and where it was created. They may also include information about when and how it was edited throughout its life. Content credentials are cryptographically associated to the content so that any alteration to the content or the credentials themselves can be detected by a C2PA-enabled client. C2PA specifications are available online [8], together with a set of comprehensive open sourced tools for both signing and validation [12].

The C2PA specification (and associated tools) covers how to generate, attach and verify a C2PA Manifest (which contains the content credentials) to media content, including audio, images and videos. Particularly, the specification covers both monolithic and fragmented MP4 (fMP4) when it comes to video, but it leaves to the individual developers the implementation of verification and visualization of fMP4, which is at the basis of modern streaming systems, like DASH.

In this paper, we present the first implementation of C2PA verification for video streaming, and a design of the UI for displaying the content credentials to the end user. Particularly, we have extended the DASH.js implementation [9] to carry out C2PA verification at the video segment level during the video streaming session. We have also developed a thoughtful UI to display the C2PA information in a non-intrusive way by leveraging the video.js framework [16]. The video playback timeline is associated with different colors based on the C2PA validation status - to signal portion of the videos that might have failed validation (i.e., have been tampered by a malicious actor). A C2PA-specific menu allows users to deep dive into the provenance information associated with the video (see Figure 1).

The remainder of this paper is structured as follows.

Section 2 provides a high-level overview on content provenance and video streaming using DASH. Section 3 provides an overview of the design of our C2PA-enabled video player, while Section 4 gives details on the implementation. Section 5 presents the demo use cases. Section 6 concludes the paper.

## 2 Background 2.1 C2Pa And Content Authenticity Initiative

Initiated by Adobe, Twitter, and The New York Times in 2019, the Content Authenticity Initiative (CAI) is a collaborative effort designed to create an industry standard for digital content attribution, which aims to provide consumers with more transparency about the origin of digital content and whether or not it has been altered. The initiative is set to address the challenge of false or misleading information proliferating on the web and empower content creators, consumers, and publishers, allowing them to benefit from accurate and trustworthy digital information [1].

Later in February 2021, the Coalition for Content Provenance and Authenticity (C2PA) was established as a joint initiative, by combining the work of the Adobeled CAI effort, and Microsoft and BBC-led Project Origin into a comprehensive initiative to provide end-toend content provenance. C2PA is joined by multiple industry leaders and aims to create a robust and industrywide technical specification for certifying the source and history (or provenance) of media content. C2PA has been adopted in multiple commercial Generative AI offerings including Adobe Firefly [5] and OpenAI DALL·E [14].

Based on the C2PA specification, open-source tools and libraries have been implemented to support the full lifecycle of C2PA claims and manifests, including creation, signing, parsing and validation across major platforms. Various media formats are supported including image, audio, video and PDF. However, the specification describes the support for streaming videos but leaves the verification and visualization process up to the developers. In this paper, we aim to fill this gap by developing the client-side manifest validation of fragmented MP4 files and the result visualization during playback on top of the DASH video player.

## 2.2 Video Streaming And Dash

Video streaming is a technology that allows users to view video content on-demand and/or in real-time over the Internet. Video streaming enables users to watch videos without having to download the entire content to their devices. This technology has become increasingly popular with the rise of online video platforms such as YouTube, Netflix, and Hulu.

Dynamic Adaptive Streaming over HTTP (DASH) [15]
is an adaptive streaming technology that allows video content to be delivered over HTTP protocol in small chunks. DASH dynamically adjusts the video bitrate based on the user's available bandwidth, screen size, and device capabilities. This ensures a seamless viewing experience by providing the highest possible video quality that the user's connection can sustain.

DASH divides a single video content into small chunks that can be downloaded individually. The fragmented MP4 (fMP4) file format, which is based on ISO Base Media File Formats (ISO BMFF), is commonly used in DASH video streaming. Compared with non-fragmented MP4 or other monolithic media file formats where provenance has been explored [2–4, 10, 13], fragmented MP4 poses new challenge for the users to verify the content provenance, as not all the fragments are available at the time of playback and verification, and individual chunks can be potentially tampered. We present an integrated player design, including a user interface to display C2PA information, addressing the above mentioned issues.

## 3 Design

In this section, we describe the design of the major components that enable the video player to verify the content authenticity during streaming: 1) how we organize the C2PA manifest and verify it for the fMP4 files with C2PA tools and SDKs, 2) how segment verification is integrated with DASH.js player, and 3) how the verification result and other information is surfaced to the viewer.

## 3.1 Signing And Verification

The provenance information including the original creator, modifications made to the content, the tools used to make these changes, and any entities who interacted with the content, is stored in a *C2PA Manifest*, together with the content, or *asset*. C2PA manifests are cryptographically bound to assets. The C2PA manifest contains a hash of the asset content that provides tamper detection. For segmented assets like fMP4, the manifest must also provide protection of not just the initialization segment but all possible media segments. The following description is how C2PA manifests protect the DASH asset.

The C2PA manifest is stored in a UUID box that is embedded in the initialization segment. The manifest contains any user supplied *C2PA assertions* information (i.e., the content credentials the user wants to associate to the content) and a BMFF Hash assertion as defined by the C2PA spec [7]. The BMFF hash contains all the hash information needed to validate the initialization segment as well as the information needed to validate the media segments. The BMFF Hash assertion contains two primary structures, a hash of the initialization segment and a Merkle tree where the leave of the tree

![3_image_0.png](3_image_0.png)

Figure 2. C2PA verification results are organized in a segment tree.

are the hashes of each media segment. A C2PA specific UUID box is also added to each media segment. This C2PA box contains a structure that specifies which Merkle tree contains this media segment, the Merkle tree leaf location of this media segments hash, and the Merkle tree proof.

At the client-side, validation of the C2PA manifest begins at the time of initialization segment loading. The C2PA manifest is loaded from the C2PA UUID box and checked for integrity and validity. The BMFF hash assertion is retrieved from the manifest, and the contained initialization hash is used to test the initialization segment for modification. If there are any issues reported in the manifest or the validation of the content of the initialization segment, then the entire DASH asset is considered invalid for C2PA purposes. Media segments are checked as they are downloaded allowing for segments to be prefetched. To do this, the hash of the contents of the media segment is calculated. The C2PA UUID box is loaded from each media segment and the enclosed Merkle tree id, the Merkle tree leaf location and the proof are extracted. The calculated hash, the Merkle leaf location, and proof are compared against the specified Merkle tree in the BMFF hash assertion. If the check succeeds the media segment is considered valid, otherwise that specific segment is C2PA invalid.

## 3.2 Dash Integration

We aim to minimize the impact from the verification process to the playback. To that end, in our design, each segment is verified once it has been fetched by the DASH player. As the DASH player will attempt

using DASH, and are verified using the C2PA SDK. The verification result is stored in a segment tree, which is used at playback time to display the correct verification status to the end user.

to prefetch segments before it is played, the verification latency can very well be hidden from the playback. The verification result will be cached inside the DASH player. As we will describe later, the player in our design queries for verification result frequently during playback. To minimize the query overhead, the verification result of the segments is organized into a segment tree based on the start and end time of each segment, together with other metadata including the stream id, adaptation and representation, as shown in Figure 2.

During playback, we will query the segment tree every time the playback time changes to get the verification result using the current time, stream id and representation as the index. The pipeline is showed in Figure 3. We claim that a frame or a timestamp of a video is successfully verified only when both the video segment and audio segment (and subtitles, and other media types if available) that are currently being played pass the verification. Since each segment is verified at the time of fetching before it is played, we expect the query will always return the result, except for rare cases during seeking where user seeks to a new segment and that segment is played immediately after it is downloaded but before the verification is completed. In that case, we provide two options: 1) playback will be temporarily paused till the verification is done and will continue with the verification result, and 2) playback will continue as soon as the segment is received, with the verification status temporarily shown as unknown. Option 1 will add a slight delay to the playback. However, such delay does not usually hurt user experience as the delay from seeking to a new segment is already there.

## 3.3 User Interface

Providing a clear view for the end user of the content validation status during the video streaming session is one of the main focus of our implementation. Differently from images and monolithic videos, DASH allows to have the same visual content encoded at different bitrate representations. Theoretically, this means that the client might fetch the same content at multiple representations at the same time. We decide to show the validation status only for the bitrate representation currently being played. In other words, the overall verification status is an indication of all the content that has been viewed so far, which may comprise segments from multiple representations. For the same reason, every time there is a seek event, the validation is recomputed based on the bitrate representation currently being played. Moreover, since the content is streamed on-demand, it is not possible to determine the complete validation status of the content beforehand (i.e., the video needs to be streamed first to be validated). In our design, we resort to show the current and past validation status of the video only.

Particularly, the user has access to a quick peek of the validation status via the color-coded timeline: **Blue**, indicating successful validation, Red, when validation has failed, and **Gray**, when nothing can be said about the C2PA status (e.g., in case of a seek event, where video segments have not been retrieved). A Content Credentials icon ( for valid content and for invalid content) allows the user to open the content credentials menu and get a deeper insight on the content itself. Mandatory fields that must be contained for the validation to be successful and that are always displayed in the menu are the authority who has signed the C2PA manifest and the signing date. Other information (like the name of the content creator, the applications used to create the content etc.) are not mandatory and can be shown in the menu depending on developers' choice.

## 4 Implementation

Our implementation is based on top of DASH.js and video.js and has been open-sourced on GitHub (https:
//github.com/contentauth/dash.js/tree/c2pa-dash).

## 4.1 Dash Integration

We propose two implementations for the DASH integration of the C2PA validation - a *plugin* style that is built on top of the regular DASH player, and a *native* one where we modify the DASH player directly. The rationale behind two parallel implementations is that we aim to provide the flexibility for deployment and adoption of our C2PA integration. The native implementation, once merged into upstream DASH.js, would be the most convenient way for websites to adopt C2PA, as the relevant functionality will available after a simple update of DASH.js version. We also recognize the need to try out the integration without merging our changes into upstream DASH.js, and the plugin implementation serves that purpose. We details the two in the following subsections. It is worth noting that, albeit different, the two implementations lead to the same end user experience in terms of functionalities and user interface. 4.1.1 Plugin. In order to validate the video segments, we need to be able to analyze them after they have been downloaded and before they are displayed. We employ the *SegmentResponseModifier* from DASH, which allows to intercept the segment before the data is appended to the buffer. We create a function that executes the C2PA validation on the segments and save the result in the segment tree (see Section 3.2). When a DASH initialization segment is retrieved, it is saved in a separate structure as it is needed to perform this validation (see Section 3.1). To communicate the validation information to the UI, we leverage a callback implemented after the *PLAYBACK_TIME_UPDATED* event provided by the DASH player, which is triggered every time the playback time of the player changes. The current playback time and current playback quality (obtained via the DASH event *QUALITY_CHANGE_RENDERED*) are used to navigate the segment tree and obtain the validation status with the associated C2PA information. This structure is then passed to the UI for visualization. In the plugin implementation, these functionalities are implemented in a standalone fashion on top of the standard DASH player.

4.1.2 Native. The same information flow has been implemented in the native implementation. In this case though, we extend the DASH player to provide the C2PA functionalities directly. We create a custom C2PA
class to perform the segment validation and the navigation of the segment tree to retrieve the validation

![5_image_0.png](5_image_0.png)

Figure 4. The C2PA timeline color codes the validation status of the streaming session, allowing a quick peek

into the content. Blue color indicates segments that have been successfully validated, while gray indicates regions for which the validation status is unknown - for example, because of seeking. The C2PA menu allows quick access to the *Content Credentials*, low-level information cryptographically bound to the content.

information. The *FRAGMENT_LOADING_COMPLETED*
event is used to intercept the segments and perform the validation, whose results are stored in the segment tree. We extend the *StreamController* class of DASH to provide an instance of the C2PA validator. During playback time update events, the *StreamController* retrieves the C2PA validation status and associated information using the segment tree and pass them back to the user interface. This is achieved using a new dedicated structure implemented in the *PLAYBACK_TIME_UPDATED* event return structure.

## 4.2 User Interface

The C2PA UI is built on top of the video.js player [16]. Particularly, we extend the standard *LoadProgressBar*, which handles the playback timeline, to support the different color codes of the C2PA validation status. A recalculation of the timeline size and segment color is triggered each time a *PLAYBACK_TIME_UPDATED* event is fired by the DASH player, leveraging the information passed from the segment tree. Similarly, we extend the standard *MenuButton* of video.js to create the C2PA menu.

## 5 Demo Scenarios

The proposed C2PA-enabled DASH player can be used to display the status of the streaming session, as depicted in Figures 4 and 1. Figure 4 presents a scenario where the C2PA validation is (currently) successful, as

Figure 5. The C2PA menu includes information on the content credentials, together with indications on whether and when the video has been tampered.

indicated by the blue color of the timeline. Moreover, it shows the behavior of the timeline during a seek event: the gray color indicates that no information is available on the status of that particular region of the content. On the other hand, Figure 1 shows a failure scenario: the red color on part of the timeline indicates that the C2PA validation has not been successful. This is indicated on the content credentials icon in the bottom left of the player, and is also re-iterated in the C2PA menu (see Figure 5). The combination of timeline and C2PA menu allows the end user to investigate the content characteristics and its provenance, and made a determination on whether the content should be trusted or not.

# 6 Conclusions

We presented in this paper our integration of the C2PA
validation for video streaming. The solution builds on top of DASH.js for the player engine and video.js for the player UI. The C2PA verification result is displayed on the player UI through the timeline and a C2PA icon, allowing viewers to quickly assess the authenticity of the content being viewed. The paper demonstrates how our solution provides robust verification, smooth playback, and an intuitive UI for users to stream videos with content authenticity.

## References

[1] Adobe. [n. d.]. Content Authenticity Initiative. https://
contentauthenticity.org/.

[2] Mansoor Ahmed-Rengers. 2019. FrameProv: towards endto-end video provenance. In Proceedings of the New Security Paradigms Workshop. 68–77.

[3] Alexander Black, Tu Bui, Simon Jenni, Viswanathan (Vishy)
Swaminathan, and John Collomosse. 2021. VPN: Video Provenance Network for Robust Content Attribution. In *Proceedings* of the 18th ACM SIGGRAPH European Conference on Visual Media Production (London, United Kingdom) *(CVMP '21)*. Association for Computing Machinery, New York, NY, USA, Article 4, 10 pages. https://doi.org/10.1145/3485441.3485650
[4] Paul England, Henrique S. Malvar, Eric Horvitz, Jack W. Stokes, Cédric Fournet, Rebecca Burke-Aguero, Amaury Chamayou, Sylvan Clebsch, Manuel Costa, John Deutscher, Shabnam Erfani, Matt Gaylor, Andrew Jenks, Kevin Kane, Elissa M. Redmiles, Alex Shamis, Isha Sharma, John C. Simmons, Sam Wenker, and Anika Zaman. 2021. AMP: authentication of media via provenance. In Proceedings of the 12th ACM Multimedia Systems Conference (Istanbul, Turkey) *(MMSys '21)*. Association for Computing Machinery, New York, NY, USA, 108–121. https://doi.org/10.1145/3458305.3459599
[5] Adobe Firefly. 2023. Content Credentials in Adobe Firefly. https://helpx.adobe.com/firefly/using/content-credentials. html.

[6] Coalition for Content Provenance and Authenticity. [n. d.].

https://c2pa.org/.

[7] Coalition for Content Provenance and Authenticity. [n. d.].

BMFF-Based Hash. https://c2pa.org/specifications/
specifications/1.3/specs/C2PA_Specification.html\#_bmff_ based_hash.

[8] Coalition for Content Provenance and Authenticity. 2023.

C2PA Specifications 2.0. https://c2pa.org/specifications/ specifications/2.0/index.html.

[9] DASH Industry Forum. [n. d.]. https://github.com/Dash-
Industry-Forum/dash.js.

[10] Ashish Gehani and Ulf Lindqvist. 2007. Veil: A system for certifying video provenance. In Ninth IEEE International Symposium on Multimedia (ISM 2007). IEEE, 263–272.

[11] White House. 2023. Executive Order on the Safe, Secure, and Trustworthy Development and Use of Artificial Intelligence.

https://www.whitehouse.gov/briefing-room/presidentialactions/2023/10/30/executive-order-on-the-safe-secureand-trustworthy-development-and-use-of-artificialintelligence/.

[12] Content Authenticity Initiative. [n. d.]. https://github.com/
contentauth.

[13] Yoshimichi Nakatsuka, Ardalan Amiri Sani, Sharad Agarwal, Gene Tsudik, et al. 2021. Vronicle: A System for Producing Videos with Verifiable Provenance. arXiv preprint arXiv:2109.12712 (2021).

[14] OpenAI. 2024. How OpenAI is approaching 2024 worldwide elections. https://openai.com/blog/how-openai-isapproaching-2024-worldwide-elections.

[15] Thomas Stockhammer. 2011. Dynamic adaptive streaming over HTTP– standards and design principles. In Proceedings of the second annual ACM conference on Multimedia systems.

133–144.

[16] Video.js. [n. d.]. https://github.com/videojs/video.js.