Conferences > 2024 IEEE International Confe... 

# Towards Privacy-Enhancing Provenance Annotations For **Images**

Publisher: IEEE Cite This  PDF
Nikolaos Fotos ; Jaime Delgado All **Authors** 
62 Full Text Views Alerts Manage Content Alerts Add to Citation Alerts Abstract Document Sections 1. Introduction 2. Background 3. Results 4. Demonstration 5. Contribution To Standards Show Full Outline Authors Figures References Keywords Metrics More Like This Abstract: The surge of media consumption on the Internet reflects how individuals engage with information, entertainment and communication. In parallel, the advancement of generati... **View more**
 **Metadata**
Abstract:
The surge of media consumption on the Internet reflects how individuals engage with information, entertainment and communication. In parallel, the advancement of generative AI tools facilitates the creation of abundant content that is nearly indistinguishable from authentic content. To address aspects of misinformation, focus is shifted towards the secure and immutable annotation of provenance information. Although such frameworks aim to establish trust in media consumption, they raise privacy concerns, as provenance data may conceal identifiable information for individuals and locations. Thus, users should be allowed to manage the level of privacy of the provenance information of a media asset. In previous work, we focused on ensuring privacy in individual provenance events pertaining to the lifecycle of an image. This paper extends the privacy techniques over well-known provenance frameworks to allow a user to protect not only specific assertions of a provenance event but even subsets of the provenance graph.

Published in: 2024 IEEE International Conference on Image Processing (ICIP)
Date of Conference: 27-30 October 2024 Date Added to IEEE *Xplore*: 27 September 2024
 **ISBN Information:**
 ISSN Information:
DOI: 10.1109/ICIP51287.2024.10647277 Publisher: IEEE
Conference Location: Abu Dhabi, United Arab Emirates Contents
   

### Section 1. Introduction

The extensive use of social media in everyday life has drastically affected the way we stay informed, we entertain ourselves, we communicate. By 2025, [1] the average daily digital media consumption in the USA will exceed 460 minutes per user. At the same time, deepfake tools and AI-empowered image processing tools complicate the digital landscape as it is nearly impossible for users to distinguish which content is real and which is synthetically generated or modified. This capitalizes the importance of tools and security measures that enable the responsible sharing and consumption of media on the Internet. The advancement of deepfake detection algorithms has proven to be an initial, yet limited solution towards addressing the issue. Once a solution is shipped and made public, other adversarial tools are available making the existing solutions obsolete, thus resulting in a never-ending endeavor.

Downl PDF
Proactive measures to address the lack of trustworthiness in media consumption include the secure annotation of metadata pertaining to the lifecycle of a digital media. This type of metadata forms the provenance information of a digital media asset. The association of the provenance information with a digital media asset forms a trust link between the subject who created or modified the asset and the end-users that consume it. Such approaches have gained the attraction of industry and academia-led initiatives in the recent years [2], [3], [4].

However, such approaches pose significant risks to the privacy of the involved stakeholders. Provenance data may conceal Personal Identifiable Information (PII) related to content creators or editors of a digital media asset. Any metadata that leads to a device or a service fingerprinting can be considered as sensitive information. In addition, the association between different provenance records can be regarded as sensitive information, especially in the context of media composition. In scenarios where an asset is created by combining multiple ingredient products, the provenance of each component needs to be protected to safeguard the ownership of the resulting asset.

All these diverse and common use cases necessitate a comprehensive solution tailored to safeguard the privacy of sensitive information based on the users' specific needs. This paper provides a holistic mechanism that enables privacy functionalities in provenance information related to digital images. It extends the Multimedia Information Protection And Management System (MIPAMS) Provenance specification [4] to empower users to selectively protect fine-grained pieces of provenance data—whether it is a specific metadata statement of a given version of an asset or a broader segment of the provenance landscape. To demonstrate the applicability of the proposed functionality and to highlight its interoperable nature, the paper presents an implementation focusing on JPEG encoded images. The practical solution adopts the provenance schema by the Coalition for Content Authenticity and Provenance (C2PA) specification while, also, adhering to wellestablished JPEG standards related to embedding data in images and applying protection mechanisms on top of them.

The remainder of the paper is as follows: Section 2 provides a background of previous work in scope of establishing trust and privacy features in provenance information. Subsequently, Section 3 presents the extended MIPAMS Provenance specification that covers privacy aspects throughout the provenance record of a digital media asset, while in Section 4 a demonstration showcasing the applicability of our proposal is presented. Section 5 describes how various parts of this paper have contributed to standardization activities.

Section 6 concludes with final remarks and future work.

### Section 2. Background

#### 2.1. Modelling Provenance **Information**

The use of provenance data in the digital media landscape demonstrates diverse applicability: use of provenance information to enable efficient querying of images [5], classification of images based on their origin [6], detection of deep fake content to combat misinformation and disinformation [7] as well as trust evaluation [8]. The extensive use of provenance information poses an imminent requirement to establish an interoperable provenance data model that can be widely adopted. To address this issue, W3C [9] published the W3C PROV family of standards [10] that covers various aspects towards the interoperable exchange of provenance information. In its core recommendation, it specifies the core terminology and data model comprising of three data types, namely the Entity, the Activity, and the Agent. Seven relations between these data types form the core date W3C Prov data model which can be extended to address application-specific requirements.

However, the plain annotation of provenance information related to digital media is not sufficient to enable a trustworthy exchange between users. Related threat vectors include the disassociation of provenance data from the related media asset or the tampering with the content of the provenance data. Protocols have been developed to address these types of attacks to provenance models, leveraging different technologies. An initial approach [2] suggests that content creators or editors should register their media assets - including their provenance data - in a trusted repository (i.e., permissioned ledger) in order to acquire a certification showing a proof of registration. To eliminate the need of maintaining a distributed ledger technology where all events over digital media are being recorded, the Coalition for Content Authenticity and Provenance (C2PA) [11] has proposed a scheme [12] that enables the secure association of provenance data with a media asset and the entity that is responsible for creating it through cryptographic means. The high-level overview of the C2PA
data model is presented in Figure 1. According to the C2PA specification, any entity is able to define statements related to a media asset as long as they take responsibility for them. A C2PA Claim groups all the provenance assertions while ensuring their integrity and taking care of their association with a specific media asset. Through the use of digital signatures (C2PA Claim signature), an entity builds the C2PA Claim signature and showcases the authenticity of the produced provenance claim. This approach establishes a trust link between the producer of a provenance claim and the media consumers. Of course, to associate the digital signature of a provenance claim with a specific identity - individual or institution - a Public Key Infrastructure
(PKI) needs to be in place.

2.2. Protection of provenance **information**

![2_image_0.png](2_image_0.png)

Figure 1: C2PA simplified entity diagram.

A thorough study [13] of existing provenance schemes in various domains as well as other works [14], [4] have highlighted the need to enable privacy capabilities in provenance applications. The privacy concerns arising from provenance metadata are multifaceted. Personal identifiable information can be included in metadata information within a provenance statement that compromise the privacy of users modifying a digital media. In addition, location information can be also described. Both pieces of information can be considered as sensitive. For instance, journalists covering a war crime incident may want to provide provenance information in a trustworthy manner while, at the same time, they may want to protect its identity and the exact GPS coordinates of the location to avoid censorship or repression The privacy concerns are extended way beyond individuals. Provenance information may disclose information about devices and services that are involved in the media asset lifecycle. To avoid device or service fingerprinting, one may decide to protect associated metadata such as the device firmware or the photo editing software. To protect such individual assertions from a provenance event, [4] introduces the Multimedia and Information Protection and Management System (MIPAMS) Provenance specification. It identifies the requirements that a provenance schema should have in order to enable privacy capabilities in sensitive statements. It also demonstrates how the proposed specification can be implemented to enable privacy features using the C2PA provenance data model in JPEG encoded images, while ensuring backwards compatibility with the existing C2PA framework.

However, the protection of a particular statement within a provenance event is only a subset of the use cases where privacy needs to be preserved. The advancement of image processing tools and the new immersive technologies of content creation result in an abundance of composited images. To keep track of the provenance record of the composite media, one has to merge the provenance events of all ingredient media assets. However, to support creativity and to protect intellectual property, it may be necessary that a user wants to protect the provenance information of the ingredient media.

Figure 2:

![3_image_0.png](3_image_0.png)

JUMBF container format.

To the best of our knowledge, this issue has not been addressed in a concrete and interoperable manner. This paper extends the MIPAMS Provenance specification in order to accommodate the aforementioned use cases where wider subsets of provenance events need to be protected without compromising the trustworthiness of the provenance data exchanged. This proposal is practically applied in the digital image domain and specifically in JPEG encoded images.

#### 2.3. Embedding And Protecting Data In **Images**

A core requirement of our proposal is that is should be adoptable from as many types of digital media as possible. Even in the context of images, only JPEG as a standardization committee has a number of formats to encode an image (i.e., JPEG 1, JPEG XL, JPEG XS, JPEG 2000). Thus, providing a solution that can be adopted by many types of media is challenging by design. To address the issue of embedding metadata within the various image formats, JPEG has defined a common container, namely the JPEG Universal Multimedia Box Format (JUMBF) [15]. It is a container format that allows the embedding of any type of data (e.g., binary, XML, JSON) within the various JPEG formats. Since it is based on the ISO Base Media File Format
(ISOBMFF) [16], JUMBF containers can be even ported into other file formats such as PDF, PNG, etc. The latest version of the JUMBF specification supports the inclusion of serialized data in XML [17], JSON [18],
and CBOR [19] formats, or any other arbitrary bitstream. As shown in Figure 2, JUMBF is a box-based container format: a JUMBF structure consists of internal box structures that are related to the embodied content and its associated metadata. A key feature of JUMBF is the ability to reference a box through a standardized URI [20] referencing scheme. This allows JUMBF to be stored separate from the image content.

This is of paramount importance, especially in the cases where the content size is negligible compared to its associated data (e.g., large provenance record of a small composited image). One key characteristic of the container format is that it is possible for other specifications - even outside of JPEG - to define their own JUMBF box formats. This is the case of the C2PA data model as it is serialized using the JUMBF format [21].

In addition, to address the need for interoperable mechanisms of protecting image content and associated metadata, JPEG has published a standard [22] that specifies how JUMBF boxes can be used to signal the encryption of a blob of data. It also covers the need for expressing access rules associated with a protected JUMBF box. From a technical standpoint, this is achieved through the definition of a new Content type JUMBF box, namely the Protection Content type JUMBF box that consists of two Content Boxes: the first one contains metadata about the encryption process (e.g., algorithm of encryption, initialization vector) while the second content box contains the ciphertext.

# Results

#### 3.1. Data **Model**

This paper builds on top of the MIPAMS Provenance specification [4] that defines the notion of a provenance event as a specific point in the history of an asset. A provenance event may describe various types of information throughout the lifecycle of a media asset: the creation of a media asset (i.e., image captured by a camera), a set of modifications applied by a user in a photo editing tool, the association of metadata accompanying a media content (e.g., EXIF or IPTC metadata in the case of digital images) or the relationship between various media assets in the context of media composition techniques (e.g., combination of foreground and background elements from various digital media sources).

The MIPAMS Provenance specification defines the requirements for a provenance event data model to enable privacy enhancing capabilities in a subset of its statements. In principle, a provenance event data model should allow for the extraction of sensitive information and its replacement with encrypted content without breaking the overall provenance framework. As shown in Figure 3, A user selects to protect Provenance event 1 by protecting Statement 3 that contains personal identifiable information. This results in the new Provenance event 1'. In parallel, the specification demonstrates how the JUMBF container and its URI
referencing scheme are beneficial towards enabling this type of privacy features. It is important that references to external pieces of information should be accompanied with the necessary integrity checks.

As a digital media asset evolves over time, the recorded provenance events increase analogously. All the

![4_image_0.png](4_image_0.png) associated provenance events that form the provenance record of a media asset can be modelled as a direct acyclic graph that starts from the source(s), the origin, of a media asset up to its newest provenance event that characterizes the latest version of the asset. In scope of the MIPAMS Provenance specification, a provenance event should be capable of expressing associations with other provenance events. Based on this requirement, it is possible to specify protection mechanisms to control the access not only on specific statements of a provenance event, but also an entire part of the provenance graph of a media asset. The importance of these mechanisms is analyzed in the following subsection through a set of use cases.

Figure 3: MIPAMS provenance specification - Protecting a statement in a provenance event.

#### 3.2. Protection Use **Cases**

Various use cases around the protection of intellectual property require that the protection of provenance information is extended beyond the statement level within a provenance event. Figure 4 summarizes three core use cases.

The first case is related to the content creation process of a digital artwork. The creator takes a source digital asset and applies various modifications on top of it. This can be an iterative process which leads to a sequence of provenance events being stored in the provenance record of the artwork. To avoid disclosing parts of its creative process, the user may select to protect the provenance events before committing them to the graph.

This allows subsequent provenance events to reference the protected container without breaking the integrity checks of the provenance graph. Users have the option to define their desired level of obfuscation by choosing to protect each provenance event individually, or by merging and protecting an entire subset of them into a unified protected payload.

In the second use case, it is possible for an editor or a service to protect part of the provenance graph of an media asset without adding new provenance events. This reactive strategy is supported by selecting a subset of the provenance graph, protecting it and replacing it with the protected payload. However, a drawback of this approach is that the provenance graph is now broken as the URI reference from newer provenance events cannot point to an accessible provenance event.

The final use case presented in the figure reuses the protection strategies presented in the previous use cases but addresses the issue of establishing a fine-grained conditional access mechanism. Content creators of composited media assets may want to share with their audience the result of their artwork but may wish to provide additional provenance information, including the references to the original media assets, only to a specific set of clients. This can be achieved by protecting the entire provenance graph of the source media assets and applying different conditional access rules according for each protected resource. There are multiple ways to express conditional access rules (e.g., XACML [23]) but the selection of the most suitable specification depends on the implementation and the application domain.

The use of the JUMBF container to embed and reference provenance events and the JPEG Privacy and Security specification to signal protected payload and conditional access rules showcases how the MIPAMS Provenance specification can be implemented in order to address the lack of an interoperable way to protect provenance information in digital images.

### Section 4. Demonstration

To demonstrate the applicability of the extended MIPAMS Provenance specification, this paper presents an application that allows authorized users - i.e., producers of provenance information - to upload digital images and commit provenance events. To address privacy concerns, producers have the ability to select the provenance events that need to be protected. Consequently, only authorized users have access to the entire provenance graph of a media asset, while unauthorized users have access only to the public provenance events. The realization of this application requires the implementation of various components. This paper provides a link to the source code of a library, namely the mipamsjpeg-systems-1.0 library, that implements the serialization of data in the JUMBF container format. This library, also, supports the JPEG Privacy &
Security JUMBF containers that enable the signaling of protected content according to the specification. Subsequently this JUMBF library is used by another library, namely the mipams-provenance-2.0 library which implements a C2PA-like data structure. The extended library supports all the necessary functionalities to enable integrity checks and digital signature operations. Finally, a dockerized web application is developed to make the production and consumption operations - offered by the mipams-provenance-2.0 library - available to users through a graphical user interface. The source code of all the components is available at: https://github.com/DMAGUPC/mipams-provenance-demonstrator. Specifically, this web application allows authorized users to upload an image and perform specific modifications to its content. These modifications are recorded as part of a temporary provenance event. The recorded provenance information can be also extended by including metadata related to the image. In fact, the application can extract EXIF metadata which is already embedded into the image and allow users to decide whether or not such metadata can be included in the provenance event. Once the provenance event is structured, users are redirected to a provenance event summary page where it is possible to specify what type of protection mechanism they want to enforce (e.g., protect the metadata or an existing event in the provenance graph). This request is wrapped and sent to the backend service, where the mipams-provenance- 2.0 library is running so that the selected protection mechanisms are executed and the final JUMBF structure is created so as to embed it in the image. For the purposes of the demonstration, self-issued certificates are used by each producer of provenance information.

These certificates are considered trusted by the application that performs the verification of all integrity checks within the context of the C2PA data model (i.e., URI references for statements as well as provenance events) and that the associated digital signature of a claim is valid.

![5_image_0.png](5_image_0.png)

This demonstration walks through a simplified version of the third use case of Figure 4. Specifically, it is assumed that an authorized user creates a composite artwork based on a source image with two provenance events associated with it. In the context of this application, authorized users with the role "PRODUCER" are assigned with the necessary credentials (i.e., asymmetric keys and digital certificates) to produce provenance information. To provide provenance metadata to the composited media asset, authorized users upload the source image to the application. Subsequently, they upload the composited image and specify its relationship with the source image. This is expressed as a parent relationship (i.e., Parent Manifest) within a new provenance event (i.e., new Manifest) that is included in the provenance graph. The contents of the new provenance event are depicted in Figure 5, including information related to the digital signing operations. Before embedding the new provenance graph to the new media asset (i.e., the composited image), the application allows the possibility for users to protect the provenance events except from the newest one as it is the latest provenance event associated with the media asset. This enables the protection of the creative work of a user, while at the same time enables authentic provenance metadata that may increase the level of trustworthiness of the image. To express specific terms and conditions of the produced content, the application supports the description of conditional access rules accompany the protection payload. In the demonstration, the XACML [23] specification is adopted to express the fact that only authorized users of role
"PRODUCER" have access to the protected resource. Consequently, the provenance information that is embedded in the new media asset is the following: (i) a JUMBF container with the latest provenance event that is accessible by all consumers, (ii) the Protection JUMBF container that contains the ciphertext of all the provenance events related to the source image, and (iii) the XML JUMBF container that contains the XACML
conditional access rules. It is worth mentioning that the application performed the These three items are wrapped into a single JUMBF container. All the references among the JUMBF containers are based on the JUMBF URI scheme specified in [15].

When parsing the media asset, users can inspect the accompanying provenance metadata. An authorized user may use the application to decrypt and parse the entire provenance graph of the composited image. Figure 5 showcases the contents of the latest and newest provenance event - i.e. Manifest). The application first checks whether the user is authorized to access the protected provenance information, it decrypts it and finally it checks the integrity of all the JUMBF URI references between the provenance events. However, in the case of non-authorized users, the application presents the newest provenance event that is publicly available. The rest of the provenance information is not available to the user as shown in Figure 6. In fact, all protected provenance events are expressed as a single blob of data under the blurred manifest entry, thus, not disclosing the number of protected events.

### Section 5.

![6_Image_0.Png](6_Image_0.Png) Contribution To Standards

![6_image_1.png](6_image_1.png)

![6_image_2.png](6_image_2.png)

The protection of specific statements of provenance events as per the MIPAMS Provenance specification is submitted as an answer to a call for proposals for the JPEG Fake Media standardization exploration [24]. It provides a complete solution for protecting information and placing it in a Protection JUMBF box, thus, maintaining compatibility with the corresponding JPEG Privacy and Security standard. This solution is also integrated to the current JPEG Trust Part 1: Core Foundations - specification which is currently in **Committee** Draft **[25]. As the JPEG Trust standardization activity evolves, its use cases and requirements [26] are being**
enhanced. One of the latest additions to the use cases of JPEG Trust is the provision of the standard to enable conditional access to the media assets contributing to a media composition action. Hence, the proposal of this paper is planned to be submitted as an input contribution to the JPEG Trust activity as it specifies how the protection of a subset of provenance graph can be achieved. Finally, concerning the implementations presented in Section 4, the mipams-jpegsystem-1.0 library that handles the JUMBF container format has been contributed as a proposed reference implementation, thus, leading the path to the development of a JPEG standard for reference software on JUMBF data which is in *Draft International Standard* **[27]. Along** with that, a dataset of JUMBF information is made available so that candidate implementors of the JUMBF specification can validate their software.

### Section 6. Conclusions

This paper presented the MIPAMS Provenance specification, a proposal that provides the means to enable

![7_image_0.png](7_image_0.png)

privacy enhancing capabilities to provenance information for images in a fine-grained fashion: it supports the protection of specific provenance assertions within a single provenance event but also identifies the way to protect an entire part of the provenance record, mainly for intellectual property purpose. To support the proposal with concrete applications, the MIPAMS Provenance specification is built on top of the C2PA provenance data model. As a future step, it is important to validate the extendibility of the proposed specification by applying the same privacy enables in other provenance data models such as the W3C PROV.

This should allow for a practical comparison between provenance data model approaches. It will provide valuable insights on determining which is the right approach so that the MIPAMS Provenance specification can be extrapolated into other types of digital media - i.e., other types of image file formats, audio or video files, and even health or genomic data. As an immediate next step towards this direction, the goal is to extend the JUMBF proposed reference software in order to accommodate additional JPEG file formats. Finally, this proposal is going to be submitted as an input contribution to the JPEG standardization activities, and specifically in the JPEG Trust standard in order to address the latest use cases and requirements pertaining to privacy and conditional access.

Figure 6: Unauthorized access to the provenance data of a composite media. User has access only to the latest Manifest.

IEEE Account
» Change Username/Password » Update Address Purchase Details
»Payment Options »Order History »View Purchased Documents Profile Information
» Communications Preferences »Profession and Education »Technical Interests Need Help?

» **US & Canada:** +1 800 678 4333 »**Worldwide:** +1 732 981 0060 » Contact & Support About IEEE *Xplore* | Contact Us | Help | Accessibility | Terms of Use | Nondiscrimination Policy | Sitemap | Privacy & Opting Out of Cookies A not-for-profit organization, IEEE is the world's largest technical professional organization dedicated to advancing technology for the benefit of humanity. © Copyright 2024 IEEE - All rights reserved. Use of this web site signifies your agreement to the terms and conditions.